<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/template/defaultTemplate.xhtml"
                xmlns:ez="http://xmlns.jcp.org/jsf/composite/ezcomp"
                xmlns:p="http://primefaces.org/ui">

    <h:outputStylesheet library="css" name="menuManagement.css" />

    <ui:define name="content">
        <style>
            /*            .ui-layout-unit-header-icon {
                            icon: 
                        }*/
        </style>

        <p:layout>
            <p:layoutUnit minSize="300" position="west">
                <f:facet name="header">
                    <div style="float: left; font-size: medium;">
                        Menu Management
                    </div>
                    <div style="text-align: right;">
                        <p:commandButton icon="fa fa-warning" style="width: 28px; height: 28px;"/>
                    </div>
                </f:facet>

                <div style="margin:5;display: flex;">
                    <div style="display: inline-block; height:auto; margin-left: auto;">
                        <p:commandButton actionListener="#{menuManagementManagedBean.collapsingORexpanding(menuManagementManagedBean.treeNode, true)}" update="treeForm" value="Expand"/>
                        <p:commandButton actionListener="#{menuManagementManagedBean.collapsingORexpanding(menuManagementManagedBean.treeNode, false)}" update="treeForm" value="Collapse"/>
                    </div>
                </div>
                <h:form id="treeForm">
                    <p:tree value="#{menuManagementManagedBean.treeNode}" var="node" selectionMode="single" selection="#{menuManagementManagedBean.selectedTreeNode}">
                        <p:treeNode type="menuCategory" expandedIcon="fa fa-list-alt" collapsedIcon="fa fa-list">
                            <h:outputText value="#{node.categoryName}" />
                        </p:treeNode>
                        <p:treeNode type="menuItem" icon="fa fa-cutlery">
                            <h:outputText value="#{node.menuItemName}" />
                        </p:treeNode>
                        <p:ajax event="select" listener="#{menuManagementManagedBean.selectTreeNode}" process="@form" update="ccViewMenuCategory:formViewMenuCategory ccViewMenuItem:formViewMenuItem"/>
                    </p:tree>
                </h:form>
            </p:layoutUnit>

            <ez:viewMenuCategory id="ccViewMenuCategory" />
            <ez:viewMenuItem id="ccViewMenuItem" />

            <p:layoutUnit position="center" >
                <p:tabView id="menuManagementTabView">
                    <p:tab id="itemsTabSelection">
                        <f:facet name="title">
                            <h:outputText value="Items"/>
                        </f:facet>

                        <h:form id="formAllMenuItems">

                            <p:messages id="messages" redisplay="false" closable="true" />

                            <p:dataTable id="dataTableAllMenuItems" widgetVar="dataTableAllMenuItems" value="#{menuManagementManagedBean.menuItems}" var="menuItem" rowKey="#{menuItem.menuItemId}" rowIndexVar="row"
                                         filteredValue="#{menuManagementManagedBean.filteredMenuItems}"
                                         rows="10" paginator="true" paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="10,20,50">

                                <f:facet name="header" >
                                    <p:outputPanel style="text-align: right;">
                                        <p:commandButton actionListener="#{menuManagementManagedBean.doCreateMenuItem}" update="menuManagementTabView:formCreateNewMenuItem" style="float: left;" oncomplete="PF('dialogCreateNewMenuItem').show()" icon="fa fa-plus-circle" />
                                        <h:outputText value="Search all fields: " />
                                        <p:inputText id="globalFilter" onkeyup="PF('dataTableAllMenuItems').filter()" style="width:300px" placeholder="Enter keyword"/>
                                    </p:outputPanel>
                                </f:facet>

                                <p:column headerText="Menu Item Code" width="120" sortBy="#{menuItem.menuItemCode}" filterBy="#{menuItem.menuItemCode}" filterMatchMode="contains">
                                    <h:outputText value="#{menuItem.menuItemCode}" />
                                </p:column>

                                <p:column headerText="Product ID" width="100" sortBy="#{menuItem.menuItemId}" filterBy="#{menuItem.menuItemId}" filterMatchMode="contains">
                                    <h:outputText value="#{menuItem.menuItemId}" />
                                </p:column>                            

                                <p:column headerText="Name" width="160" sortBy="#{menuItem.menuItemName}" filterBy="#{menuItem.menuItemName}" filterMatchMode="contains">
                                    <h:outputText value="#{menuItem.menuItemName}" />
                                </p:column>

                                <p:column headerText="Unit Price" width="100" sortBy="#{menuItem.menuItemPrice}" filterBy="#{menuItem.menuItemPrice}" filterMatchMode="contains" style="text-align: right;">
                                    <h:outputText value="#{menuItem.menuItemPrice}">
                                        <f:convertNumber minFractionDigits="2" maxFractionDigits="2" type="currency" currencyCode="SGD" />
                                    </h:outputText>
                                </p:column>

                                <p:column headerText="Waiting Time (mins)" width="150" sortBy="#{menuItem.waitingTimeMinutes}" filterBy="#{menuItem.waitingTimeMinutes}" filterMatchMode="contains" style="text-align: right;">
                                    <h:outputText value="#{menuItem.waitingTimeMinutes}"/>
                                </p:column>

                                <p:column headerText="Availability" width="150" sortBy="#{menuItem.availability}" filterBy="#{menuItem.availability}" filterMatchMode="exact">
                                    <f:facet name="filter">
                                        <p:selectOneMenu id="selAvailability" onchange="PF('dataTableAllMenuItems').filter()">
                                            <f:selectItem itemValue="#{null}" itemLabel="[Select One]" noSelectionOption="true" />
                                            <f:selectItems value="#{menuManagementManagedBean.menuItemAvailabilities}" var="availability" itemValue="#{availability}" itemLabel="#{availability}" />
                                        </p:selectOneMenu>
                                    </f:facet>
                                    <i class="fa #{menuItem.availability == 'SELLING_FAST' ? 'fa-level-up' : menuItem.availability == 'AVAILABLE' ? 'fa-thumbs-up' : 'fa-times'}" style="float: left"/>
                                    <h:outputText value="#{menuItem.availability}"/>
                                </p:column>

                                <p:column headerText="Category" width="130" sortBy="#{menuItem.menuCategory.categoryName}" filterBy="#{menuItem.menuCategory.categoryName}" filterMatchMode="exact">
                                    <f:facet name="filter">
                                        <p:selectOneMenu id="selCategory" onchange="PF('dataTableAllMenuItems').filter()">
                                            <f:selectItem itemValue="#{null}" itemLabel="[Select One]" noSelectionOption="true" />
                                            <f:selectItems value="#{menuManagementManagedBean.leafMenuCategories}" var="menuCategory" itemValue="#{menuCategory.categoryName}" itemLabel="#{menuCategory.categoryName}" />
                                        </p:selectOneMenu>
                                    </f:facet>
                                    <h:outputText value="#{menuItem.menuCategory.categoryName}" />
                                </p:column>

                                <p:column headerText="Action" width="100" style="text-align: center">
                                    <p:commandButton update="ccViewMenuItem:formViewMenuItem" oncomplete="PF('dialogViewMenuItem').show()" icon="fa fa-search" title="View">
                                        <f:setPropertyActionListener value="#{menuItem}" target="#{menuManagementManagedBean.viewMenuItemManagedBean.menuItemToView}" />
                                        <f:attribute name="menuItemToView" value="#{menuItem}" />
                                    </p:commandButton>

                                    <p:commandButton actionListener="#{menuManagementManagedBean.doUpdateMenuItem}" update="menuManagementTabView:formUpdateMenuItem" oncomplete="PF('dialogUpdateMenuItem').show()" icon="fa fa-pencil" title="Update">
                                        <f:attribute name="menuItemToUpdate" value="#{menuItem}" />
                                    </p:commandButton>

                                    <p:commandButton icon="fa fa-trash" actionListener="#{menuManagementManagedBean.deleteMenuItem}" update="menuManagementTabView:formAllMenuItems:dataTableAllMenuItems menuManagementTabView:formAllMenuItems:messages treeForm">
                                        <f:attribute name="menuItemToDelete" value="#{menuItem}" />
                                        <p:confirm header="Confirmation" message="Are you sure you want to delete #{menuItem.menuItemName} (Menu Item Code: #{menuItem.menuItemCode})?" icon="fa fa-warning" />
                                    </p:commandButton>

                                </p:column>

                            </p:dataTable>

                            <!--This is for delete menu item-->
                            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                <p:commandButton value="Yes" type="button" styleClass="fa fa-check" icon="ui-icon-check" />
                                <p:commandButton value="No" type="button" styleClass="fa fa-close" icon="ui-icon-close" />
                            </p:confirmDialog>

                        </h:form>

                        <h:form id="formCreateNewMenuItem">

                            <p:dialog id="dialogCreateNewMenuItem" widgetVar="dialogCreateNewMenuItem" header="Create New Menu Item" closable="true">

                                <p:messages id="messagesCreateNewMenuItem" redisplay="false" />

                                <p:panelGrid id="createNewMenuItemPanel">
                                    <p:row id="photoRow" rendered="#{menuManagementManagedBean.createMenuItemPreviewPhoto != null}">
                                        <p:column colspan="3">
                                            <div style='text-align: center;'>
                                                <img src="data:image/png;base64,#{menuManagementManagedBean.createMenuItemPreviewPhotoContents}" style="margin: 15px; width: 180px; height: 180px;" alt="Photo not loaded"/>
                                                <br/>
                                                Picture Preview
                                            </div>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="menuItemCode" value="Item Code: " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="menuItemCode" value="#{menuManagementManagedBean.menuItemToCreate.menuItemCode}" placeholder="MI999" required="true" requiredMessage="Item Code is required" size="64" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="menuItemCode" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="name" value="Name: " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="name" value="#{menuManagementManagedBean.menuItemToCreate.menuItemName}" placeholder="Menu Item 1" required="true" requiredMessage="Name is required" size="64" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="name" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="description" value="Description " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="description" value="#{menuManagementManagedBean.menuItemToCreate.menuItemDescription}" placeholder="Menu Item 1" required="false" requiredMessage="Description is required" size="64" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="description" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="unitPrice" value="Unit Price " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>                            
                                            <p:spinner id="unitPrice" value="#{menuManagementManagedBean.menuItemToCreate.menuItemPrice}" placeholder="10.00" min="0" max="1000000" stepFactor="0.10" required="true" requiredMessage="Item Unit Price is required" size="60" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="unitPrice" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="waitingTime" value="Waiting Time (mins) " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:spinner id="waitingTime" value="#{menuManagementManagedBean.menuItemToCreate.waitingTimeMinutes}" placeholder="10" min="0" stepFactor="1" required="true" requiredMessage="Waiting Time is required" size="60" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="waitingTime" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="selAvailability" value="Availability " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="selAvailability" value="#{menuManagementManagedBean.menuItemToCreate.availability}">
                                                <f:selectItems value="#{menuManagementManagedBean.menuItemAvailabilities}" var="availability" itemValue="#{availability}" itemLabel="#{availability}" />
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:message for="selAvailability" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="selCategory" value="Category " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="selCategory" value="#{menuManagementManagedBean.menuCategoryIdToCreate}">
                                                <f:selectItem itemValue="0" itemLabel="[Select One]" noSelectionOption="true" />
                                                <f:selectItems value="#{menuManagementManagedBean.leafMenuCategories}" var="menuCategory" itemValue="#{menuCategory.menuCategoryId}" itemLabel="#{menuCategory.categoryName}" />
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:message for="selCategory" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel value="Picture Upload" style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:fileUpload id="pictureUpload" update="@form" fileUploadListener="#{menuManagementManagedBean.uploadCreateMenuItemPreviewPhoto}"
                                                          previewWidth="1" allowTypes="/(\.|\/)(gif|jpe?g|png|GIF|JPE?G|PNG)$/" chooseIcon="fa fa-file-photo-o" label="" 
                                                          cancelIcon="fa fa-remove" cancelLabel="" uploadIcon="fa fa-upload" uploadLabel="" multiple="false" fileLimit="1"
                                                          oncomplete="PF('dialogCreateNewMenuItem').show()"/>
                                        </p:column>
                                        <p:column>
                                            <p:message for="pictureUpload" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column colspan="3">
                                            <p:commandButton type="reset" value="Clear" />&nbsp;
                                            <p:commandButton  value="Create New Menu Item" update="@form menuManagementTabView:formAllMenuItems:dataTableAllMenuItems menuManagementTabView:formCreateNewMenuCategory:createNewMenuCategoryPanel treeForm" actionListener="#{menuManagementManagedBean.createNewMenuItem}" oncomplete="PF('dialogCreateNewMenuItem').show();" />
                                        </p:column>
                                    </p:row>

                                </p:panelGrid>

                            </p:dialog>

                        </h:form>



                        <h:form id="formUpdateMenuItem">

                            <p:dialog id="dialogUpdateMenuItem" widgetVar="dialogUpdateMenuItem" header="Update Menu Item" closable="true" height="500">

                                <p:messages id="messagesUpdateMenuItem" redisplay="false" />

                                <p:panelGrid>

                                    <p:row rendered="#{menuManagementManagedBean.menuItemToUpdate.imagePath != null || menuManagementManagedBean.updateMenuItemPreviewPhoto != null}">
                                        <p:column colspan="3">
                                            <div style='text-align: center;'>
                                                <ui:fragment rendered="#{menuManagementManagedBean.updateMenuItemPreviewPhoto == null  and menuManagementManagedBean.cropMode == false and menuManagementManagedBean.updateMenuItemCurrentPhotoContents != null}" >
                                                    <img src="data:image/png;base64,#{menuManagementManagedBean.updateMenuItemCurrentPhotoContents}" style="margin: 15px; width: 180px; height: 180px;" alt="Picture not loaded"/>
                                                    <br/>
                                                    <p:commandButton icon='fa fa-trash' update='@form' actionListener="#{menuManagementManagedBean.removeMenuItemPhoto}" oncomplete="PF('dialogUpdateMenuItem').show();"/>
                                                    <p:commandButton icon='fa fa-edit' update='@form' actionListener="#{menuManagementManagedBean.doCropMenuItemPhoto}" oncomplete="PF('dialogUpdateMenuItem').show();"/>
                                                </ui:fragment>
                                                <!--CROPPER-->
                                                <ui:fragment rendered="#{menuManagementManagedBean.cropMode == true}">
                                                    <p:imageCropper id="menuItemImageCropper" value="#{menuManagementManagedBean.croppedImage}" image="/resources/images/food/#{menuManagementManagedBean.menuItemToUpdate.imagePath}" initialCoords="0,0,0,0" minSize="50,50" maxSize="180,180" boxHeight="180" aspectRatio="1.0"/>
                                                    <br/>
                                                    <p:commandButton icon='fa fa-times' update='@form' actionListener="#{menuManagementManagedBean.doExitCropMenuItemPhoto}" oncomplete="PF('dialogUpdateMenuItem').show();"/>
                                                </ui:fragment>

                                                <ui:fragment rendered="#{menuManagementManagedBean.updateMenuItemPreviewPhoto != null}" >
                                                    <img src="data:image/png;base64,#{menuManagementManagedBean.updateMenuItemPreviewPhotoContents}" style="margin: 15px; height: 180px;"/>
                                                    <br/>
                                                    <h4>Picture Preview</h4>
                                                </ui:fragment>
                                            </div>
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <h:outputLabel value="Menu Item ID: " />
                                        </p:column>
                                        <p:column>
                                            <h:outputText value="#{menuManagementManagedBean.menuItemToUpdate.menuItemId}" />
                                        </p:column>
                                        <p:column>
                                            &nbsp;
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <h:outputLabel value="Menu Item Code: " />
                                        </p:column>
                                        <p:column>
                                            <h:outputText value="#{menuManagementManagedBean.menuItemToUpdate.menuItemCode}"/>
                                        </p:column>
                                        <p:column>
                                            &nbsp;
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="name" value="Name: " />
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="name" value="#{menuManagementManagedBean.menuItemToUpdate.menuItemName}" placeholder="Menu Item 1" required="true" requiredMessage="Name is required" size="64" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="name" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="description" value="Description " />
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="description" value="#{menuManagementManagedBean.menuItemToUpdate.menuItemDescription}" placeholder="Menu Item 1" required="false" requiredMessage="Description is required" size="64" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="description" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="unitPrice" value="Unit Price " />
                                        </p:column>
                                        <p:column>
                                            <p:spinner id="unitPrice" value="#{menuManagementManagedBean.menuItemToUpdate.menuItemPrice}" placeholder="10.00" min="0" max="1000000" stepFactor="0.1" required="true" requiredMessage="Unit Price is required" size="60" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="unitPrice" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="waitingTime" value="Wating Time (mins) " />
                                        </p:column>
                                        <p:column>
                                            <p:spinner id="waitingTime" value="#{menuManagementManagedBean.menuItemToUpdate.waitingTimeMinutes}" placeholder="10" min="0" max="500" stepFactor="1" required="true" requiredMessage="Waiting Time is required" size="60" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="waitingTime" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="selAvailability" value="Availability " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="selAvailability" value="#{menuManagementManagedBean.menuItemToUpdate.availability}">
                                                <f:selectItems value="#{menuManagementManagedBean.menuItemAvailabilities}" var="availability" itemValue="#{availability}" itemLabel="#{availability}" />
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:message for="selAvailability" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="selCategory" value="Category " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="selCategory" value="#{menuManagementManagedBean.menuCategoryIdToUpdate}">
                                                <f:selectItem itemValue="0" itemLabel="[Select One]" noSelectionOption="true" />
                                                <f:selectItems value="#{menuManagementManagedBean.leafMenuCategories}" var="menuCategory" itemValue="#{menuCategory.menuCategoryId}" itemLabel="#{menuCategory.categoryName}" />
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:message for="selCategory" />
                                        </p:column>
                                    </p:row>

                                    <p:row rendered="#{menuManagementManagedBean.cropMode == false}">
                                        <p:column>
                                            <p:outputLabel value="Picture Upload" style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:fileUpload id="pictureUploadUpdate" update="@form" fileUploadListener="#{menuManagementManagedBean.uploadUpdateMenuItemPreviewPhoto}"
                                                          previewWidth="1" allowTypes="/(\.|\/)(gif|jpe?g|png|GIF|JPE?G|PNG)$/" chooseIcon="fa fa-file-photo-o" label="" 
                                                          cancelIcon="fa fa-remove" cancelLabel="" uploadIcon="fa fa-upload" uploadLabel="" multiple="false" fileLimit="1"
                                                          oncomplete="PF('dialogUpdateMenuItem').show()"/>
                                        </p:column>
                                        <p:column>
                                            <p:message for="pictureUploadUpdate" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column colspan="3">
                                            <p:commandButton value="Update Menu Item" update="@form menuManagementTabView:formAllMenuItems:dataTableAllMenuItems menuManagementTabView:formCreateNewMenuCategory:createNewMenuCategoryPanel ccViewMenuItem:formViewMenuItem treeForm" actionListener="#{menuManagementManagedBean.updateMenuItem}" oncomplete="PF('dialogUpdateMenuItem').show();" />
                                            <p:commandButton value="Close" oncomplete="PF('dialogUpdateMenuItem').hide();" />
                                        </p:column>
                                    </p:row>

                                </p:panelGrid>

                            </p:dialog>

                        </h:form>

                    </p:tab>
                    <p:tab>
                        <f:facet name="title">
                            <h:outputText value="Categories"/>
                        </f:facet>

                        <h:form id="formAllMenuCategories">

                            <p:messages id="messages" redisplay="false" closable="true" />

                            <p:dataTable id="dataTableAllMenuCategories" widgetVar="dataTableAllMenuCategories" value="#{menuManagementManagedBean.menuCategories}" var="menuCategory" rowKey="#{menuCategory.menuCategoryId}" rowIndexVar="row"
                                         filteredValue="#{menuManagementManagedBean.filteredMenuCategories}"
                                         rows="10" paginator="true" paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="10,20,50">

                                <f:facet name="header">
                                    <p:outputPanel style="text-align: right;">
                                        <p:commandButton style="float: left;" onclick="PF('dialogCreateNewMenuCategory').show()" icon="fa fa-plus-circle" />
                                        <h:outputText value="Search all fields: " />
                                        <p:inputText id="globalFilter" onkeyup="PF('dataTableAllMenuCategories').filter()" style="width:300px" placeholder="Enter keyword"/>
                                    </p:outputPanel>
                                </f:facet>

                                <p:column headerText="Menu Category ID" sortBy="#{menuCategory.menuCategoryId}" filterBy="#{menuCategory.menuCategoryId}" filterMatchMode="contains">
                                    <h:outputText value="#{menuCategory.menuCategoryId}" />
                                </p:column>                      

                                <p:column headerText="Name" sortBy="#{menuCategory.categoryName}" filterBy="#{menuCategory.categoryName}" filterMatchMode="contains">
                                    <h:outputText value="#{menuCategory.categoryName}" />
                                </p:column>

                                <p:column headerText="Parent Category" sortBy="#{menuCategory.parentMenuCategory.categoryName}" filterBy="#{menuCategory.parentMenuCategory.categoryName}" filterMatchMode="exact">
                                    <f:facet name="filter">
                                        <p:selectOneMenu id="selCategory" onchange="PF('dataTableAllMenuCategories').filter()">
                                            <f:selectItem itemValue="#{null}" itemLabel="[Select One]" noSelectionOption="true" />
                                            <f:selectItems value="#{menuManagementManagedBean.rootMenuCategories}" var="menuCategory" itemValue="#{menuCategory.categoryName}" itemLabel="#{menuCategory.categoryName}" />
                                        </p:selectOneMenu>
                                    </f:facet>
                                    <h:outputText value="#{menuCategory.parentMenuCategory.categoryName}" />
                                </p:column>

                                <p:column headerText="Action" width="100" style="text-align: center">

                                    <p:commandButton update="ccViewMenuCategory:formViewMenuCategory" oncomplete="PF('dialogViewMenuCategory').show()" icon="fa fa-search" title="View">
                                        <f:setPropertyActionListener value="#{menuCategory}" target="#{menuManagementManagedBean.viewMenuCategoryManagedBean.menuCategoryToView}" />
                                    </p:commandButton>

                                    <p:commandButton actionListener="#{menuManagementManagedBean.doUpdateMenuCategory}" update="menuManagementTabView:formUpdateMenuCategory" oncomplete="PF('dialogUpdateMenuCategory').show()" icon="fa fa-pencil" title="Update">
                                        <f:attribute name="menuCategoryToUpdate" value="#{menuCategory}" />
                                    </p:commandButton>

                                    <p:commandButton icon="fa fa-trash" actionListener="#{menuManagementManagedBean.deleteMenuCategory}" update="
                                                     menuManagementTabView:formAllMenuCategories:dataTableAllMenuCategories menuManagementTabView:formAllMenuCategories:messages menuManagementTabView:formCreateNewMenuItem:createNewMenuItemPanel treeForm">
                                        <f:attribute name="menuCategoryToDelete" value="#{menuCategory}" />
                                        <p:confirm header="Confirmation" message="Are you sure you want to delete #{menuCategory.categoryName}?" icon="fa fa-warning" />
                                    </p:commandButton>

                                </p:column>

                            </p:dataTable>

                            <!--This is for delete menu category-->
                            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="fa fa-check" />
                                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="fa fa-close" />
                            </p:confirmDialog>

                        </h:form>

                        <h:form id="formCreateNewMenuCategory">

                            <p:dialog id="dialogCreateNewMenuCategory" widgetVar="dialogCreateNewMenuCategory" header="Create New Menu Category" resizable="false" closable="true">

                                <p:messages id="messagesCreateNewMenuCategory" redisplay="false" />

                                <p:panelGrid id="createNewMenuCategoryPanel">

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="name" value="Name: " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="name" value="#{menuManagementManagedBean.menuCategoryToCreate.categoryName}" placeholder="Menu Category 1" required="true" requiredMessage="Name is required" size="64" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="name" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="selCategory" value="Parent Category " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="selCategory" value="#{menuManagementManagedBean.parentMenuCategoryIdToCreate}">
                                                <f:selectItem itemValue="0" itemLabel="[Select One]" noSelectionOption="true" />
                                                <f:selectItems value="#{menuManagementManagedBean.rootMenuCategories}" var="parentMenuCategory" itemValue="#{parentMenuCategory.menuCategoryId}" itemLabel="#{parentMenuCategory.categoryName}" />
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:message for="selCategory" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column colspan="3">
                                            <p:commandButton type="reset" value="Clear" />&nbsp;
                                            <p:commandButton  value="Create New Menu Category" update="@form menuManagementTabView:formAllMenuCategories:dataTableAllMenuCategories menuManagementTabView:formCreateNewMenuCategory menuManagementTabView:formCreateNewMenuItem:createNewMenuItemPanel treeForm" actionListener="#{menuManagementManagedBean.createNewMenuCategory}" oncomplete="PF('dialogCreateNewMenuCategory').show();" />
                                        </p:column>
                                    </p:row>

                                </p:panelGrid>

                            </p:dialog>

                        </h:form>



                        <h:form id="formUpdateMenuCategory">

                            <p:dialog id="dialogUpdateMenuCategory" widgetVar="dialogUpdateMenuCategory" header="Update Menu Category" closable="true">

                                <p:messages id="messagesUpdateMenuCategory" redisplay="false" />

                                <p:panelGrid>

                                    <p:row>
                                        <p:column>
                                            <h:outputLabel value="Menu Category ID: " />
                                        </p:column>
                                        <p:column>
                                            <h:outputText value="#{menuManagementManagedBean.menuCategoryToUpdate.menuCategoryId}" />
                                        </p:column>
                                        <p:column>
                                            &nbsp;
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="name" value="Name: " />
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="name" value="#{menuManagementManagedBean.menuCategoryToUpdate.categoryName}" placeholder="Menu Category 1" required="true" requiredMessage="Name is required" size="64" />
                                        </p:column>
                                        <p:column>
                                            <p:message for="name" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column>
                                            <p:outputLabel for="selCategory" value="Parent Category " style="font-weight: bold;" />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="selCategory" value="#{menuManagementManagedBean.parentMenuCategoryIdToUpdate}">
                                                <f:selectItem itemValue="0" itemLabel="[Select One]" noSelectionOption="true" />
                                                <f:selectItems value="#{menuManagementManagedBean.menuCategoriesWithoutItems}" var="parentMenuCategory" itemValue="#{parentMenuCategory.menuCategoryId}" itemLabel="#{parentMenuCategory.categoryName}" />
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>
                                            <p:message for="selCategory" />
                                        </p:column>
                                    </p:row>

                                    <p:row>
                                        <p:column colspan="3">
                                            <p:commandButton value="Update Menu Category" update="@form menuManagementTabView:formAllMenuCategories:dataTableAllMenuCategories menuManagementTabView:formCreateNewMenuCategory:createNewMenuCategoryPanel  menuManagementTabView:formAllMenuItems:dataTableAllMenuItems menuManagementTabView:formCreateNewMenuItem:createNewMenuItemPanel treeForm" actionListener="#{menuManagementManagedBean.updateMenuCategory}" oncomplete="PF('dialogUpdateMenuCategory').show();" />
                                            <p:commandButton value="Close" oncomplete="PF('dialogUpdateMenuCategory').hide();" />
                                        </p:column>
                                    </p:row>

                                </p:panelGrid>

                            </p:dialog>

                        </h:form>

                    </p:tab>
                </p:tabView>
            </p:layoutUnit>
        </p:layout>
    </ui:define>
</ui:composition>

